<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Helmy Card - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…ØªÙƒØ§Ù…Ù„</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700;900&display=swap');
        
        :root {
            --gold: linear-gradient(135deg, #bf953f 0%, #fcf6ba 45%, #b38728 70%, #fbf5b7 100%);
            --bg: #050505;
            --card-bg: #0d0d0d;
            --text-gold: #fcf6ba;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background-color: var(--bg);
            background-image: radial-gradient(circle at top left, #1a1a1a, #050505);
            color: #f8fafc; margin: 0; display: flex; align-items: center; justify-content: center; min-height: 100vh; padding: 20px;
        }

        .form-card {
            background: var(--card-bg);
            border: 1px solid rgba(191, 149, 63, 0.3);
            border-radius: 30px;
            padding: 30px; width: 100%; max-width: 480px; 
            box-shadow: 0 25px 50px rgba(0,0,0,0.9);
            position: relative;
        }

        /* Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø®ÙÙŠØ© */
        #adminPanel {
            display: none; background: #0f0f0f; border: 2px solid #bf953f;
            padding: 20px; border-radius: 20px; position: absolute;
            top: 5px; left: 5px; right: 5px; z-index: 2000; max-height: 90vh; overflow-y: auto;
        }

        .header { text-align: center; margin-bottom: 25px; cursor: pointer; }
        .header h1 { 
            font-size: 32px; font-weight: 900; margin: 0;
            background: var(--gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        
        .copy-box { 
            background: rgba(191, 149, 63, 0.08); padding: 15px; border-radius: 15px; 
            border: 1px dashed #bf953f; margin-top: 15px; font-size: 14px;
        }

        .input-group { margin-bottom: 18px; text-align: right; }
        label { display: block; margin-bottom: 6px; font-size: 13px; color: var(--text-gold); font-weight: bold; }

        input, select {
            width: 100%; background: #151515; border: 1px solid rgba(191, 149, 63, 0.2);
            border-radius: 12px; padding: 12px; color: white; font-size: 15px; box-sizing: border-box; outline: none;
        }

        .calc-box { background: rgba(191, 149, 63, 0.05); padding: 15px; border-radius: 15px; text-align: center; margin: 15px 0; border: 1px solid rgba(191, 149, 63, 0.1); }
        .calc-value { font-size: 22px; font-weight: 700; color: #fff; }

        button#submitBtn {
            width: 100%; padding: 16px; background: var(--gold);
            border: none; border-radius: 12px; color: #000; font-size: 18px; font-weight: 700; cursor: pointer;
        }

        /* ØªØµÙ…ÙŠÙ… Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠ */
        #invoiceOverlay {
            display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.95); z-index: 3000; align-items: center; justify-content: center; padding: 20px;
        }
        .invoice-box { 
            background: #0d0d0d; color: #fff; width: 100%; max-width: 400px; padding: 30px; 
            border-radius: 25px; text-align: center; border: 2px solid #bf953f; 
            box-shadow: 0 0 30px rgba(191, 149, 63, 0.3);
        }
        .inv-header { font-size: 24px; font-weight: 900; background: var(--gold); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 20px; }
        .inv-item { display: flex; justify-content: space-between; border-bottom: 1px solid rgba(191, 149, 63, 0.1); padding: 12px 0; font-size: 14px; }
        .inv-label { color: #94a3b8; }
        .inv-value { color: #fcf6ba; font-weight: bold; }

        .admin-save-btn { background: var(--gold); color: #000; padding: 12px; border: none; border-radius: 10px; width: 100%; font-weight: bold; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>

<div class="form-card">
    <div id="adminPanel">
        <h3 style="color:gold; text-align:center;">âš™ï¸ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>
        <div class="input-group"><label>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹</label><input type="text" id="set_title"></div>
        <div class="input-group"><label>Ù†Øµ Ø§Ù„ØªØ­Ø°ÙŠØ±</label><input type="text" id="set_warn"></div>
        <div class="input-group"><label>ID Ø§Ù„Ø³Ø­Ø¨</label><input type="text" id="set_aid"></div>
        <div class="input-group"><label>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…</label><input type="text" id="set_aname"></div>
        <h4 style="color:gold;">Ø§Ù„Ø®Ø§Ù†Ø§Øª ÙˆØ§Ù„Ø£Ø³Ø¹Ø§Ø±</h4>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
            <div class="input-group"><label>Ø§Ø³Ù… Ø®Ø§Ù†Ø© ID</label><input type="text" id="set_luid"></div>
            <div class="input-group"><label>Ø§Ø³Ù… Ø®Ø§Ù†Ø© Ø§Ù„ÙˆÙƒÙŠÙ„</label><input type="text" id="set_lagent"></div>
            <div class="input-group"><label>Ø³Ø¹Ø± ÙÙˆØ¯Ø§ÙÙˆÙ†</label><input type="number" id="r_v"></div>
            <div class="input-group"><label>Ø³Ø¹Ø± Ø§Ù„ÙˆÙƒÙŠÙ„</label><input type="number" id="r_a"></div>
        </div>
        <button class="admin-save-btn" onclick="saveSettings()">Ø­ÙØ¸ ÙˆØªØ·Ø¨ÙŠÙ‚ âœ…</button>
        <button onclick="document.getElementById('adminPanel').style.display='none'" style="width:100%; background:red; color:#fff; border:none; border-radius:10px; padding:10px; margin-top:5px;">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>

    <div class="header" onclick="checkAdmin()">
        <h1 id="disp_title">Helmy Card ğŸ”—</h1>
        <span id="disp_warn" style="color:#ff4d4d; font-size:12px; font-weight:bold;"></span>
        <div class="copy-box" onclick="copyId()">
            ID Ø³Ø­Ø¨: <b id="disp_aid"></b><br>
            Ø§Ù„Ø§Ø³Ù…: <b id="disp_aname"></b><br>
            <small>Ø§Ø¶ØºØ· Ù„Ù„Ù†Ø³Ø® ğŸ‘†</small>
        </div>
    </div>

    <div class="input-group"><label id="lbl_uid"></label><input type="text" id="user_id"></div>
    <div class="input-group"><label id="lbl_agent"></label><input type="text" id="agent_name"></div>

    <div class="input-group">
        <label>Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø¯ÙØ¹</label>
        <select id="method" onchange="calculate()">
            <option value="ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´">ÙÙˆØ¯Ø§ÙÙˆÙ† ÙƒØ§Ø´</option>
            <option value="Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´">Ø§ØªØµØ§Ù„Ø§Øª ÙƒØ§Ø´</option>
            <option value="Ø£ÙˆØ±Ù†Ø¬ ÙƒØ§Ø´">Ø£ÙˆØ±Ù†Ø¬ ÙƒØ§Ø´</option>
            <option value="ÙƒÙˆØ¯ Ø§Ù„ÙˆÙƒÙŠÙ„">ÙƒÙˆØ¯ Ø§Ù„ÙˆÙƒÙŠÙ„ (Ø³Ø¹Ø± Ø®Ø§Øµ)</option>
        </select>
    </div>

    <div class="input-group">
        <label>Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±</label>
        <input type="number" id="dollars" placeholder="0.00" oninput="calculate()">
    </div>

    <div class="calc-box"><div class="calc-value" id="res-egp">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 0.00 Ø¬.Ù…</div></div>

    <div class="input-group"><label>Ø±Ù‚Ù… Ø§Ù„Ø§Ø³ØªÙ„Ø§Ù…</label><input type="text" id="wallet" placeholder="01xxxxxxxxx"></div>
    <div class="input-group"><label>ØµÙˆØ±Ø© Ø§Ù„ØªØ­ÙˆÙŠÙ„</label><input type="file" id="screenshot" accept="image/*"></div>

    <button onclick="submitForm()" id="submitBtn">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø¢Ù† ğŸš€</button>
</div>

<div id="invoiceOverlay">
    <div class="invoice-box">
        <div class="inv-header">ÙØ§ØªÙˆØ±Ø© Ø³Ø­Ø¨ Ø±Ø§ØªØ¨ âœ…</div>
        <div class="inv-item"><span class="inv-label">ID Ø§Ù„Ø­Ø³Ø§Ø¨:</span> <span class="inv-value" id="inv-uid"></span></div>
        <div class="inv-item"><span class="inv-label">Ø§Ù„ÙˆÙƒÙŠÙ„:</span> <span class="inv-value" id="inv-agent"></span></div>
        <div class="inv-item"><span class="inv-label">Ø§Ù„Ù…Ø¨Ù„Øº:</span> <span class="inv-value" id="inv-egp"></span></div>
        <div class="inv-item"><span class="inv-label">Ø§Ù„Ø·Ø±ÙŠÙ‚Ø©:</span> <span class="inv-value" id="inv-method"></span></div>
        <div class="inv-item"><span class="inv-label">Ø§Ù„ÙŠÙˆÙ…:</span> <span class="inv-value" id="inv-day"></span></div>
        <div class="inv-item"><span class="inv-label">Ø§Ù„ØªØ§Ø±ÙŠØ®:</span> <span class="inv-value" id="inv-time" style="font-size:11px;"></span></div>
        <div style="margin-top:20px; font-size:12px; color:gold; font-style:italic;">Ø´ÙƒØ±Ù‹Ø§ Ù„Ø«Ù‚ØªÙƒ Ø¨Ù€ Helmy Card ğŸ”—</div>
        <button onclick="location.reload()" class="admin-save-btn">Ø¥ØºÙ„Ø§Ù‚ ÙˆØ­ÙØ¸</button>
    </div>
</div>

<script>
    let config = {
        title: "Helmy Card ğŸ”—", warn: "ÙŠØ³ØªØºØ±Ù‚ ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ§Ø±Ø¬Øª ÙˆØ¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ 24 Ø³Ø§Ø¹Ø©",
        aid: "800050", aname: "Helmy fire",
        luid: "ğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ Ø§Ù„Ù…Ø³Ø­ÙˆØ¨ Ù…Ù†Ù‡", lagent: "ğŸ‘¤ Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„",
        rv: 45, ra: 46.5
    };

    const SHEET_URL = 'https://sheetdb.io/api/v1/5t77aw7docius?sheet=Karak chat';
    const TG_TOKEN = "8493256102:AAFuFPixyivycVPImhz7dMAtpcP0-NsZMpk";
    const TG_CHAT_ID = "7054064246";

    window.onload = function() {
        const saved = localStorage.getItem('helmy_ultimate_cfg');
        if(saved) config = JSON.parse(saved);
        applyConfig();
    };

    function applyConfig() {
        document.getElementById('disp_title').innerText = config.title;
        document.getElementById('disp_warn').innerText = config.warn;
        document.getElementById('disp_aid').innerText = config.aid;
        document.getElementById('disp_aname').innerText = config.aname;
        document.getElementById('lbl_uid').innerText = config.luid;
        document.getElementById('lbl_agent').innerText = config.lagent;
        
        document.getElementById('set_title').value = config.title;
        document.getElementById('set_warn').value = config.warn;
        document.getElementById('set_aid').value = config.aid;
        document.getElementById('set_aname').value = config.aname;
        document.getElementById('set_luid').value = config.luid;
        document.getElementById('set_lagent').value = config.lagent;
        document.getElementById('r_v').value = config.rv;
        document.getElementById('r_a').value = config.ra;
        calculate();
    }

    function checkAdmin() { if(prompt("ÙƒÙ„Ù…Ø© Ø³Ø± Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©:") === "1997") document.getElementById('adminPanel').style.display='block'; }

    function saveSettings() {
        config.title = document.getElementById('set_title').value;
        config.warn = document.getElementById('set_warn').value;
        config.aid = document.getElementById('set_aid').value;
        config.aname = document.getElementById('set_aname').value;
        config.luid = document.getElementById('set_luid').value;
        config.lagent = document.getElementById('set_lagent').value;
        config.rv = parseFloat(document.getElementById('r_v').value);
        config.ra = parseFloat(document.getElementById('r_a').value);
        localStorage.setItem('helmy_ultimate_cfg', JSON.stringify(config));
        applyConfig();
        document.getElementById('adminPanel').style.display='none';
    }

    function calculate() {
        const usd = document.getElementById('dollars').value || 0;
        const rate = document.getElementById('method').value.includes("Ø§Ù„ÙˆÙƒÙŠÙ„") ? config.ra : config.rv;
        document.getElementById('res-egp').innerText = "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: " + (usd * rate).toFixed(2) + " Ø¬.Ù…";
    }

    async function submitForm() {
        const btn = document.getElementById('submitBtn');
        const uid = document.getElementById('user_id').value;
        const agent = document.getElementById('agent_name').value || "Ù„Ø§ ÙŠÙˆØ¬Ø¯";
        const usdVal = document.getElementById('dollars').value;
        const wallet = document.getElementById('wallet').value;
        const photo = document.getElementById('screenshot').files[0];
        const method = document.getElementById('method').value;

        if(!uid || !usdVal || !wallet || !photo) return alert("Ø§ÙƒÙ…Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª!");

        btn.disabled = true; btn.innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...";

        try {
            const rate = method.includes("Ø§Ù„ÙˆÙƒÙŠÙ„") ? config.ra : config.rv;
            const egpVal = (usdVal * rate).toFixed(2);
            
            const now = new Date();
            const days = ["Ø§Ù„Ø£Ø­Ø¯", "Ø§Ù„Ø§Ø«Ù†ÙŠÙ†", "Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡", "Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡", "Ø§Ù„Ø®Ù…ÙŠØ³", "Ø§Ù„Ø¬Ù…Ø¹Ø©", "Ø§Ù„Ø³Ø¨Øª"];
            const currentDay = days[now.getDay()];
            const dateStr = now.toLocaleDateString('en-GB');
            const timeStr = now.toLocaleTimeString('ar-EG');

            // ØªÙ„ÙŠØ¬Ø±Ø§Ù…
            const msg = `ğŸ§¾ *Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯*\nğŸ†” Ø§Ù„Ø£ÙŠØ¯ÙŠ: ${uid}\nğŸ‘¤ Ø§Ù„ÙˆÙƒÙŠÙ„: ${agent}\nğŸ’µ Ø¯ÙˆÙ„Ø§Ø±: ${usdVal}$\nğŸ‡ªğŸ‡¬ Ù…ØµØ±ÙŠ: ${egpVal}\nğŸ’³ Ø·Ø±ÙŠÙ‚Ø©: ${method}\nğŸ¦ Ù…Ø­ÙØ¸Ø©: ${wallet}\nğŸ“… Ø§Ù„ÙŠÙˆÙ…: ${currentDay}\nâ° Ø§Ù„ØªØ§Ø±ÙŠØ®: ${dateStr}`;
            const fd = new FormData();
            fd.append('chat_id', TG_CHAT_ID); fd.append('photo', photo); fd.append('caption', msg); fd.append('parse_mode', 'Markdown');
            await fetch(`https://api.telegram.org/bot${TG_TOKEN}/sendPhoto`, { method: 'POST', body: fd });

            // Ø§Ù„Ø¥ÙƒØ³Ù„ (SheetDB) - Ø¥Ø±Ø³Ø§Ù„ ÙƒØ§ÙØ© Ø§Ù„Ø­Ù‚ÙˆÙ„ Ø¨Ù…Ø§ ÙÙŠÙ‡Ø§ Ø§Ù„ÙŠÙˆÙ…
            await fetch(SHEET_URL, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ data: [{
                    "Ø§Ù„Ø£ÙŠØ¯ÙŠ": uid,
                    "Ø§Ø³Ù… Ø§Ù„ÙˆÙƒÙŠÙ„": agent,
                    "Ø§Ù„Ø¯ÙˆÙ„Ø§Ø±": usdVal + " $",
                    "Ø§Ù„Ù…ØµØ±ÙŠ": egpVal + " Ø¬.Ù…",
                    "Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ø³Ø­Ø¨": method,
                    "Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙØ¸Ø©": "'" + wallet,
                    "Ø§Ù„ÙŠÙˆÙ…": currentDay,
                    "Ø§Ù„ØªØ§Ø±ÙŠØ®": dateStr + " " + timeStr
                }]})
            });

            // Ù…Ù„Ø¡ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
            document.getElementById('inv-uid').innerText = uid;
            document.getElementById('inv-agent').innerText = agent;
            document.getElementById('inv-egp').innerText = egpVal + " Ø¬.Ù…";
            document.getElementById('inv-method').innerText = method;
            document.getElementById('inv-day').innerText = currentDay;
            document.getElementById('inv-time').innerText = dateStr + " " + timeStr;
            document.getElementById('invoiceOverlay').style.display = 'flex';

        } catch(e) { alert("Ø®Ø·Ø£!"); btn.disabled = false; }
    }

    function copyId() { navigator.clipboard.writeText(config.aid); alert("ØªÙ… Ø§Ù„Ù†Ø³Ø® âœ…"); }
</script>
</body>
</html>
